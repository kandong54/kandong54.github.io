"use strict";(self.webpackChunkweb_app=self.webpackChunkweb_app||[]).push([[103],{9103:(W,c,s)=>{s.r(c),s.d(c,{CameraModule:()=>S});var f=s(9808),l=s(4100),i=s(5e3),v=s(4398);const y=["myCanvas"],p=[{path:"",component:(()=>{class t{constructor(e,a){this.clientService=e,this.router=a,this.imageStream=null,this.ctx=null,this.myCanvas={},this.cameraWidth=960,this.cameraHeight=720,this.imageWidth=640,this.imageHeight=640}ngOnInit(){this.clientService.connect().then(e=>{console.log("Connect result:",e)}).catch(e=>{alert("Connection error: "+e),this.router.navigate(["/login"])})}ngAfterViewInit(){this.myCanvas.nativeElement.width=this.imageWidth,this.myCanvas.nativeElement.height=this.imageHeight,this.myCanvas.nativeElement.style.aspectRatio=this.cameraWidth/this.cameraHeight,this.ctx=this.myCanvas.nativeElement.getContext("2d"),this.ctx.strokeStyle="red",this.ctx.font="48px Roboto",this.clientService.connect().then(e=>{if(!0===e){if(this.imageStream=this.clientService.getCamera(),null===this.imageStream)return void alert("Failed to get camera data!");this.imageStream.on("error",r=>alert("Connection error: "+r)),this.imageStream.on("end",()=>alert("Connection ends."));let a=new Uint8ClampedArray(this.imageWidth*this.imageHeight*4);a.fill(255),this.imageStream.on("data",r=>{let h=r.getImage_asU8(),R=r.getBoxList();if(null!=this.ctx){for(let n=0,m=0;n<a.length;n+=4,m+=3)a[n]=h[m],a[n+1]=h[m+1],a[n+2]=h[m+2];let H=new ImageData(a,this.imageWidth,this.imageHeight);this.ctx.putImageData(H,0,0);for(const n of R){let m=n.getXCenter()*this.imageWidth,M=n.getYCenter()*this.imageHeight,g=n.getWidth()*this.imageWidth,C=n.getHeight()*this.imageHeight,u=m-g/2,d=M-C/2;this.ctx.strokeRect(u,d,g,C);let B=n.getConfidence();this.ctx.fillText(Math.round(100*B)+"%",u,d)}}})}})}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(v.y),i.Y36(l.F0))},t.\u0275cmp=i.Xpm({type:t,selectors:[["app-camera"]],viewQuery:function(e,a){if(1&e&&i.Gf(y,5),2&e){let r;i.iGM(r=i.CRH())&&(a.myCanvas=r.first)}},decls:3,vars:0,consts:[[1,"fullscreen"],["myCanvas",""]],template:function(e,a){1&e&&(i.TgZ(0,"div",0),i._UZ(1,"canvas",null,1),i.qZA())},styles:[".fullscreen[_ngcontent-%COMP%]{display:flex;justify-content:center}"]}),t})()}];let x=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({imports:[[l.Bz.forChild(p)],l.Bz]}),t})(),S=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({imports:[[f.ez,x]]}),t})()}}]);