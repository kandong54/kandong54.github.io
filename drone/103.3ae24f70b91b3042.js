"use strict";(self.webpackChunkweb_app=self.webpackChunkweb_app||[]).push([[103],{9103:(F,c,o)=>{o.r(c),o.d(c,{CameraModule:()=>w});var f=o(9808),m=o(4100),a=o(5e3),v=o(4398);const p=["myCanvas"],y=[{path:"",component:(()=>{class t{constructor(e,r){this.clientService=e,this.router=r,this.imageStream=null,this.myCanvas={},this.cameraWidth=960,this.cameraHeight=720,this.imageWidth=640,this.imageHeight=640,this.interval=1e3,this.lastTime=Date.now()}ngOnInit(){this.clientService.connect().then(e=>{console.log("Connect result:",e)}).catch(e=>{alert("Connection error: "+e),this.router.navigate(["/login"])})}ngAfterViewInit(){this.myCanvas.nativeElement.width=this.cameraWidth,this.myCanvas.nativeElement.height=this.cameraHeight;var e=this.myCanvas.nativeElement.getContext("2d");e.strokeStyle="red",e.font="48px Roboto",this.clientService.connect().then(r=>{if(!0===r){if(this.imageStream=this.clientService.getCamera(),null===this.imageStream)return void alert("Failed to get camera data!");this.imageStream.on("error",l=>alert("Connection error: "+l)),this.imageStream.on("end",()=>alert("Connection ends."));let i=new Image;this.imageStream.on("data",l=>{let h=Date.now(),x=h-this.lastTime;this.lastTime=h,this.interval=.5*this.interval+.5*x;let R=l.getImage_asU8(),M=l.getBoxList(),T=new Blob([R],{type:"image/jpeg"});URL.revokeObjectURL(i.src),i.src=URL.createObjectURL(T),i.onload=()=>{e.drawImage(i,0,0,this.imageWidth,this.imageHeight,0,0,this.cameraWidth,this.cameraHeight),e.fillText("FPS: "+(1e3/this.interval).toFixed(2),10,50);for(const s of M){let u=s.getLeft(),d=s.getTop(),b=s.getWidth(),C=s.getHeight();e.strokeRect(u,d,b,C);let B=s.getConfidence();e.fillText(Math.round(100*B)+"%",u,d+C)}}})}})}}return t.\u0275fac=function(e){return new(e||t)(a.Y36(v.y),a.Y36(m.F0))},t.\u0275cmp=a.Xpm({type:t,selectors:[["app-camera"]],viewQuery:function(e,r){if(1&e&&a.Gf(p,5),2&e){let i;a.iGM(i=a.CRH())&&(r.myCanvas=i.first)}},decls:3,vars:0,consts:[[1,"fullscreen"],["myCanvas",""]],template:function(e,r){1&e&&(a.TgZ(0,"div",0),a._UZ(1,"canvas",null,1),a.qZA())},styles:[".fullscreen[_ngcontent-%COMP%]{display:flex;justify-content:center}"]}),t})()}];let S=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=a.oAB({type:t}),t.\u0275inj=a.cJS({imports:[[m.Bz.forChild(y)],m.Bz]}),t})(),w=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=a.oAB({type:t}),t.\u0275inj=a.cJS({imports:[[f.ez,S]]}),t})()}}]);