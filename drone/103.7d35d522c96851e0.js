"use strict";(self.webpackChunkweb_app=self.webpackChunkweb_app||[]).push([[103],{9103:(B,l,o)=>{o.r(l),o.d(l,{CameraModule:()=>S});var d=o(9808),c=o(4100),a=o(5e3),f=o(4398);const v=["myCanvas"],y=[{path:"",component:(()=>{class t{constructor(e,r){this.clientService=e,this.router=r,this.imageStream=null,this.myCanvas={},this.cameraWidth=960,this.cameraHeight=720,this.imageWidth=640,this.imageHeight=640}ngOnInit(){this.clientService.connect().then(e=>{console.log("Connect result:",e)}).catch(e=>{alert("Connection error: "+e),this.router.navigate(["/login"])})}ngAfterViewInit(){this.myCanvas.nativeElement.width=this.imageWidth,this.myCanvas.nativeElement.height=this.imageHeight,this.myCanvas.nativeElement.style.aspectRatio=this.cameraWidth/this.cameraHeight;var e=this.myCanvas.nativeElement.getContext("2d");e.strokeStyle="red",e.font="48px Roboto",this.clientService.connect().then(r=>{if(!0===r){if(this.imageStream=this.clientService.getCamera(),null===this.imageStream)return void alert("Failed to get camera data!");this.imageStream.on("error",m=>alert("Connection error: "+m)),this.imageStream.on("end",()=>alert("Connection ends."));let i=new Image;this.imageStream.on("data",m=>{let R=m.getImage_asU8(),x=m.getBoxList(),M=new Blob([R],{type:"image/jpeg"});URL.revokeObjectURL(i.src),i.src=URL.createObjectURL(M),i.onload=()=>{e.drawImage(i,0,0);for(const s of x){let w=s.getXCenter()*this.imageWidth,H=s.getYCenter()*this.imageHeight,h=s.getWidth()*this.imageWidth,g=s.getHeight()*this.imageHeight,C=w-h/2,u=H-g/2;e.strokeRect(C,u,h,g);let b=s.getConfidence();e.fillText(Math.round(100*b)+"%",C,u)}}})}})}}return t.\u0275fac=function(e){return new(e||t)(a.Y36(f.y),a.Y36(c.F0))},t.\u0275cmp=a.Xpm({type:t,selectors:[["app-camera"]],viewQuery:function(e,r){if(1&e&&a.Gf(v,5),2&e){let i;a.iGM(i=a.CRH())&&(r.myCanvas=i.first)}},decls:3,vars:0,consts:[[1,"fullscreen"],["myCanvas",""]],template:function(e,r){1&e&&(a.TgZ(0,"div",0),a._UZ(1,"canvas",null,1),a.qZA())},styles:[".fullscreen[_ngcontent-%COMP%]{display:flex;justify-content:center}"]}),t})()}];let p=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=a.oAB({type:t}),t.\u0275inj=a.cJS({imports:[[c.Bz.forChild(y)],c.Bz]}),t})(),S=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=a.oAB({type:t}),t.\u0275inj=a.cJS({imports:[[d.ez,p]]}),t})()}}]);