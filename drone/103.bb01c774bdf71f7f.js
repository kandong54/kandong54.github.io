"use strict";(self.webpackChunkweb_app=self.webpackChunkweb_app||[]).push([[103],{9103:(A,h,i)=>{i.r(h),i.d(h,{CameraModule:()=>R});var f=i(9808),s=i(4100),a=i(5e3),v=i(4398);const y=["myCanvas"],p=[{path:"",component:(()=>{class t{constructor(e,o){this.clientService=e,this.router=o,this.imageStream=null,this.myCanvas={},this.cameraWidth=960,this.cameraHeight=720,this.imageWidth=640,this.imageHeight=640}ngOnInit(){this.clientService.connect().then(e=>{console.log("Connect result:",e)}).catch(e=>{alert("Connection error: "+e),this.router.navigate(["/login"])})}ngAfterViewInit(){this.myCanvas.nativeElement.width=this.imageWidth,this.myCanvas.nativeElement.height=this.imageHeight,this.myCanvas.nativeElement.style.aspectRatio=this.cameraWidth/this.cameraHeight;var e=this.myCanvas.nativeElement.getContext("2d");e.strokeStyle="red",e.font="48px Roboto",this.clientService.connect().then(o=>{if(!0===o){if(this.imageStream=this.clientService.getCamera(),null===this.imageStream)return void alert("Failed to get camera data!");this.imageStream.on("error",m=>alert("Connection error: "+m)),this.imageStream.on("end",()=>alert("Connection ends.")),new Uint8ClampedArray(this.imageWidth*this.imageHeight*4).fill(255),this.imageStream.on("data",m=>{let w=m.getImage_asU8(),x=m.getBoxList(),M=new Blob([w],{type:"image/jpeg"}),c=new Image;c.src=URL.createObjectURL(M),c.onload=()=>{e.drawImage(c,0,0);for(const r of x){let B=r.getXCenter()*this.imageWidth,H=r.getYCenter()*this.imageHeight,g=r.getWidth()*this.imageWidth,C=r.getHeight()*this.imageHeight,u=B-g/2,d=H-C/2;e.strokeRect(u,d,g,C);let W=r.getConfidence();e.fillText(Math.round(100*W)+"%",u,d)}}})}})}}return t.\u0275fac=function(e){return new(e||t)(a.Y36(v.y),a.Y36(s.F0))},t.\u0275cmp=a.Xpm({type:t,selectors:[["app-camera"]],viewQuery:function(e,o){if(1&e&&a.Gf(y,5),2&e){let l;a.iGM(l=a.CRH())&&(o.myCanvas=l.first)}},decls:3,vars:0,consts:[[1,"fullscreen"],["myCanvas",""]],template:function(e,o){1&e&&(a.TgZ(0,"div",0),a._UZ(1,"canvas",null,1),a.qZA())},styles:[".fullscreen[_ngcontent-%COMP%]{display:flex;justify-content:center}"]}),t})()}];let S=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=a.oAB({type:t}),t.\u0275inj=a.cJS({imports:[[s.Bz.forChild(p)],s.Bz]}),t})(),R=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=a.oAB({type:t}),t.\u0275inj=a.cJS({imports:[[f.ez,S]]}),t})()}}]);